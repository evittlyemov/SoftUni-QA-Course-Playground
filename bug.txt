Some bugs were fixed by not so lazy dev.